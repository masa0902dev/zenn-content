---
title: "【計算統計物理】論文ノート、英単語や用語ノート"
emoji: "📝"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["研究", "計算統計物理", "論文", "英語"]
published: true
---

# これは何？
- 主に計算統計物理分野の論文/スライド等を読んだ際のノート、関連事項を調べたノート。
- 英単語や用語の意味と使われ方のメモ。
- 論文を読むたびに追記する。

:::message alert
CAUTION:
1. 他の分野や文脈においては、用語等の意味合いが違う場合もあります。
2. 私の知識不足により誤りを含む可能性があります。
:::

:::details 個人的なZennメモ

TODO: 私が後でやるべきこと
ASK: 私が後で聞くべきこと
RES: 私が後で考えてみたりシミュレートしてみたいこと

- Zennでの数式の参考 (Zennは$\KaTeX$が使える):
  - `npx zenn preview`で見れば良い。
  - ⭕️: $a=10$, ❌: $ a=10 $ (インラインは空白ダメ)
  - ブロックは普通に$*2で。ただし、上を1行空ける必要あり。
  - [Zennで数式を書く方法](https://zenn.dev/dmiyamo3/articles/34fb48a88aa813beffc0)
  - [Zennで数式を表示する](https://zenn.dev/ykyki/articles/math-formulae-in-zenn)

- Zennでの目次は、heading2まで表示される。
- [ZennのMarkdown記法一覧](https://zenn.dev/zenn/articles/markdown-guide)
:::



# 論文
## D. Mugita 2024: Microscopic Mechanisms of Diffusion Dynamics…
https://arxiv.org/abs/2410.05590
author: Daigo Mugita, Masaharu Isobe

included:
- structural relaxation in highly dense system
- fluid phase and solid phase
- hard disk / sphere system
- Newtonian Event-Chain (NEC), Straight Event-Chain (SEC), Event-Chain Monte Carlo (ECMC)
- Efficiency analysis with respect to event-chain length (Lc), duration (Tc), system size, and relaxation performance
- diffusion coefficients in equilibruim state (NOT equilibration)

not included:
- coexistence phase or hexatic phase
- algorithmic details or derivation of the NEC method itself -> TODO: read paper about NEC algorithm itself

### Ⅰ. intro

- substantial 実質的な。かなりの。
- seminal: 大きな影響を与えた

平衡化と緩和は似ているが違う。平衡化は平衡状態に向かう全体的なプロセスで、緩和は局所的な乱れが静まる個別の道筋。
平衡状態は、定温・定体積系では：自由エネルギー F=U-TS が最小。平衡化はこのFが極小に近づいていく過程に対応。

- equilibration: 平衡化。非平衡状態から平衡状態に到達するまでの動的過程、プロセス。
- equilibrium: 平衡。時間的にマクロな観測量が変化しない状態、定常状態。
- relaxation: 緩和。緩和時間τ（相関の消失にかかる時間）に使う、自己相関関数 $C(t) \sim exp(-t/\tau)$。τが大きいほど相関が長く残るので、状態の記憶が長く、独立な状態が得にくくなる。

- methodology: 方法論。戦略的なアプローチ
- elucidate: 解明する
- incorporate: 取り入れる。新たな要素・理論・手法などを既存モデル・アルゴリズムに組み込む

ECMCは、MCMC（Markov Chain Monte Carlo）に factorization, liftingの概念を適用したサンプリング手法。

- factorization: 因数分解。特にMCMCでは、目的分布π(x)を条件付き分布の積として因数分解すること。高次元からのサンプリングを、部分空間でのサンプリングに分割できる。
- lifting: 遷移。特にMCMCでは、元のマルコフ連鎖の状態空間を拡張して、より効率的（高速）な遷移を可能にする手法。通常のMCMCでは時間的に可逆な遷移だが、リフティングによって非可逆（非対称）な遷移を導入して拡散を早める。

Metroppolis filterとは、試行遷移（trial move）を受け入れるか拒否するかを決めるフィルター処理。
このフィルターによって、望ましい平衡分布（例えばボルツマン分布）に従うサンプル列が得られる。つまり、メトロポリスアルゴリズムの需要確率の部分そのもの。
状態xに例えば方向や速度などの補助変数を加えて、変数を拡張する。これによって「進行方向に沿ったバイアスのある遷移」ができて、ランダム性を減らせる。

$$
受容確率A(x -> x') = min(1, \frac{\pi(x')}{\pi(x)}) \\
\pi(x)は目標とする平衡分布で、例えばボルツマン分布 \pi(x) = \exp(-\beta E(x))
$$

新しい状態がより低エネなら必ず受け入れる。高エネでも確率的に受け入れる（これは局所最適化に陥らないためである）。
このフィルターによって、詳細釣り合い条件（detailed balance）を満たした平衡分布を得る。

これに対し、ECMCは factorization, liftingによって高速なサンプリングを実現している。
ECMCは、MCMCと違って detailed balance は満たさない（満たすことを必須としない設計だ）が、global balance (全体釣り合い条件)を満たしている。

- consist of: ~から成り立つ。

ECMCはアクティブ粒子のほか粒子との衝突をイベントとする。

NEC（Newtonian Event-Chain）はECMCの一種。粒子位置の置き換えの際に、粒子の速度vを考慮する。これはEDMDのアナロジーである。
NECは特に、融解過程・核形成速度・拡散係数を計算する際に大きな優位をもつ。
NECはさらに、hard anistoropic particle (硬い（オーバーラップしない、重ならない）異方性（形状に対称性の破れがある、楕円や棒状など）粒子) への適用が「近似なしで」可能。これは、効率的な接触検出アルゴリズムを組み込んだことで実現した。

- analoguos: ~に類似して。アナロジーの形容詞。

- necleation rates: 核形成速度、Jで書かれることが多い？単位体積・単位時間あたりに新たな核が生じる確率。
核形成: 系の中に、小さな新しい相が自発的に生じる現象。
- diffusion coefficients: 拡散係数、Dで書かれることが多い。

- anisotropic: 異方性の。anisotropy（異方性）の形容詞

i.e. / e.g. どっちがどっち？

```text
e.g. → for example: ギリシャ語でexempli gratia。具体例をあげる。

Sophie loves picking fruit (e.g., strawberries, apples, blueberries and peaches).
ソフィーは果物狩りが好きです（たとえばイチゴ、リンゴ、ブルーベリー、桃など）


i.e. → that is / in other words (つまり)：ギリシャ語でid est。言い換えたり明確化する。specifically, namely。

Only one president, i.e., Richard Nixon, resigned from office.
辞任した大統領は1人、すなわちリチャード・ニクソンだけです
```

- exceptionally: 並外れて、非常に（程度が例外的に大きいってこと）

構造緩和（粒子位置の緩和）は、特に高密度系では、非常に困難。なぜなら、排除体積効果が支配的だから。
排除体積効果が支配的だと、粒子が1回のイベントで動ける程度（その状態から変化できる程度）が非常に小さい。なぜなら…
1. 粒子が互いにめり込めないので、自由に動けないから。（自由に動ける距離が小さいから）
2. （高密度系では、粒子が詰まっているから1イベントあたりに動ける距離が小さいから）

上記が原因となって構造緩和の進行が遅いことで、系の時間自己相関関数はなかなか減衰しない。

- excluded-volume effect: 排除体積効果。
排除体積は、ある粒子が存在するときにその周囲に他の粒子が侵入できない空間、のこと。これは、単なる幾何学的な粒子のサイズだけの話ではなく、粒子の形状や向きにも依存する。
- dominant excluded-volume effect: 系の性質（相転移、構造など）が、エネルギー的要因ではなく、ほとんど排除体積効果だけによって決まっている状態。つまり、粒子同士の引力や静電相互作用などはほとんど関与せず、粒子が互いに重ならないという条件だけが、系のマクロな挙動を支配している状態。
これは、高密度・ハード粒子系で典型的である。

構造緩和は、glassy physics (ガラス状態やガラス天威の統計力学的な性質などの分野) での「slow dynamics (遅い動力学, 系が時間に対して非常にゆっくりと進展する現象や対象)」おいて、最大の関心事だ。
ガラスなどの、高密度系での構造緩和を(定量的に)評価するにあたって、MSD, ISF, NGPは重要な指標となる。

そもそもガラスとは: 液体のように無秩序だが、個体のように動かない物質の状態のこと。構造的には液体（短距離秩序しかない）だが、力学的には固体（剪断応答する）というハイブリッド。

- metrics: 指標。

<br>

**MSD**, mean square displacement:
粒子の平均的な移動距離の2乗を時間経過とともに測った量

$$
MSD(t) = \langle |\vec{r(t)} - \vec{r(0)}|^2 \rangle
$$
<.>は、粒子と初期時刻についての平均。MSDが十分に大きな値に達すれば、それは粒子がもはや初期位置を覚えていないということ。よって、MSDが十分大きければ、構造緩和が完了したと言える。

**ISF**, intermediate scattering function:
ミクロな密度揺らぎの時間的相関を測る関数。

$$
F_s (q, t) = \langle \exp(i q \cdot |\vec{r(t)} - \vec{r(0)}| ) \rangle
$$
qは波数ベクトル、<.>はアンサンブル平均（または時間平均）。初期時刻で Fs(q,0) = 1 (完全相関)。時間が経つと、粒子が動いてFs(q,t)は0に減衰する。減衰の仕方から、特定スケールでの構造緩和の進行状況がわかる。
Fsが十分に0近くに減衰したら、粒子の配置が記憶を失ったということ。よって、ISFが十分大きければ、構造緩和が完了したと言える。
特に、緩和時間$\tau_\alpha$(α-緩和時間)を$F_s(q,\tau_\alpha) = \langle \exp(i q \cdot |\vec{r(\tau_\alpha)} - \vec{r(0)}| ) \rangle = e^{-1}$となる時間として定義することが多い。

**NGP**, non-gaussian parameter:
粒子の移動分布が単なるガウス分布（正規分布）からどれだけズレているかを定量化する指標。

$$
2次元系の典型 (3次元系なら分母にかけてる係数が3になる) \\
\def \DIFF #1 { |\vec{r(t)} - \vec{r(0)}|^{#1} }
\def \ANGLE #1 { \langle #1 \rangle }

\alpha_2 (t) = \frac{ \ANGLE{\DIFF{4}} }{2 \ANGLE{\DIFF{2}} ^2 } - 1
$$
G的挙動(理想的なG分布)、つまり普通のブラウン運動なら $\alpha_2(t)=0$。
$\alpha_2(t)>0$なら、G分布に比べて、遠くまで動く粒子が多く存在する(広がった移動分布（尾が太い）を持つ)。
構造緩和の過程で、NGPはピークを持つことが多い。このピーク時刻は、粒子軍における異常な動きの最大化時点と対応し、$\tau_\alpha$ (α-緩和時間) に近いことが多い。

<br>

ensemble average (アンサンブル平均):
ある時刻に存在しうる全ての状態を集めた「仮想的な集団（＝アンサンブル）」に対して、その物理量の平均をとること。
エルゴード仮説が成り立つ場合、アンサンブル平均と時間平均は一致するとされる(エルゴード仮説のもとで考えることが多い)。アンサンブル平均は、ある物理量の**その時刻における**状態の平均なので注意。

$$
物理量Aのアンサンブル平均 \\
\langle A \rangle = \int A(x)P(x) dx
$$
P(x)は状態xにある確率（平衡分布なら、ボルツマン分布）。確率的に重み付けして平均することで、ミクロな揺らぎを均して、再現性のあるマクロな物理量が得られる。
粒子位置、エネルギー、自己相関関数、MSD, ISFなどに用いられることが多い。


ECMC, EDMDの構造緩和・粒子拡散の数値的アプローチは大きく異なるため、その性能比較は困難だ。

- metastable state: 準安定状態。完全な安定状態（熱力学的平衡）ではないが、長い時間安定して存在できる状態。
最終的には、より低い自由エネの本当の平衡状態に移行する。しかし、そこへ行くためにエネルギー障壁があり、それをなかなか越えられないので、長い時間安定して存在できる状態。自由エネが局所的な最小値をとっている状態。
安定状態(global minimum)も準安定状態(local minimum)も、自由エネFについて$\frac{dF}{dx}=0, \frac{d^2F}{dx^2}>0$を満たす。極小値なので当然。

- attain: 達する。達成する
- optimal: 最適な
- physical properties: 物理的特性。propertyが加算で「特性」。科学的なニュアンスでは特性の意味が多い。
- elusive: 見つけたりするのが困難、達成するのが困難。形容詞

ここでは、構造緩和の効率を測定するために、イベント（衝突）回数・CPU時間を用いている。
（ただし、NECのチェイン長さには、CPU時間ではなく粒子の持つ速度vを用いて時間を計算する。チェイン長さはTc）

### Ⅱ. model and simulation methods

粒子のエネルギーは$1/\beta = 1/k_B T$としている。
質量m, 直径d = 2σ としているので、次元解析から、自然な時間単位τは下記の式になる。

- unit of time: 時間単位。系の時間的なスケールを測るための基準量。計算統計物理では、時間単位は「自然単位」で定義することが多い（この自然単位==1となるように値を取ることが多い）。
  次元解析によって定めるには、この場合、粒子直径d、質量m、エネルギー1/β (熱エネルギー)を用いる。
  自然な時間単位τは、粒子が自分のサイズ分動くのにかかる典型時間が基準となる。
  
  $$
  \tau = d \sqrt{\beta m}
  $$
  この自然単位τは、例えばNECの鎖長Tc（チェーン時間）を計算する際に現れるわけではない。しかし、シミュレーション結果の物理解釈において、構造緩和や拡散係数と結びつけて考えるにはτが必要。
  

- 次元解析
L, M, T（長さ、質量、時間）から考える。
上例では、L=2σ=d, M=m, E=1/β である。

$$
E = \frac{1}{2} m v^2 などから (エネルギーE)=M L^2 T^{-2} \\
\therefore T = L \sqrt{E^{-1} M}
$$

[相転移について既知の情報] **ハードディスクのシステムについて**、システムの充填率 $\nu = \pi \sigma^2 \cdot N / A$ (2D, A is area) に対しての相↓

| $\nu$ | state | description |
| ----- | ----- | ----------- |
| v < 0.700 | liquid | 粒子は完全にランダムに動ける。短距離秩序しかない。MSDがすぐリニアになり、緩和構造時間が短い |
| 0.700 < v < 0.716 | coexistence region (liquid and solid) | 巨視的には相分離が見られる（結晶ドメイン＋液体領域）。第一種相転移の兆候 (最近のEDMDやECMCの大規模計算によって検出された) |
| 0.716 < v < 0.720 | hexatic | 方向秩序はあるが、位置秩序はない中間的な相。イメージとしては、配向秩序変数が異なる固相が複数ある状態（グローバル配向秩序変数を考慮する必要はある） |
| 0.720 < v | crystal | 粒子が結晶格子状に配置。六方格子構造。並進秩序が準長距離的に存在している。動きは小さく、拡散係数が0に近づく |

ここでは、液相と固相のみシミュレートしている。

2次元系における固体化は、3次元系とは本質的に異なる。
3d: liquid -> solid の第一種相転移。2d: 段階的に変化する。中間層が現れる。

- threshold: 閾、閾値（しきいち）。

NECは、粒子の速度分布としてMaxwell-Boltzmann分布を与える（EDMDと似ている）。鎖長として、粒子の速度と移動距離から計算した経過時間を合計したTcを用いる。粒子の速度には、$v_{rms} = \sqrt{\langle v^2 \rangle}$を用いる（二乗のアンサンブル平均のルート, root mean square）。

- diffusion coefficients: 拡散係数D。coefficitent==係数。

ここでは拡散係数として、$D_{ev}$ (based on number of events $N^*_{ev}$), $D_{cpu}$ (based on CPU time $t_{cpu}$) を用いる（M. Klement 2019, H. Banno 2022 に対応）。DはMSDから計算。

$$
\gdef \MSD {\langle |\Delta \vec{r} - \langle \Delta \vec{r} \rangle |^2 \rangle}

\MSD = \frac{1}{N} \sum_{i=1}^{N} |\Delta \vec{r_i} - \langle \Delta \vec{r} \rangle |^2 \\
$$
$$
\def \MSD {\langle |\Delta \vec{r} - \langle \Delta \vec{r} \rangle |^2 \rangle}

D_{ev} = \lim_{N^*_{ev} \rightarrow \infty} \frac{\MSD}{4N^*_{ev}} \\
D_{cpu} = \lim_{t_{cpu} \rightarrow \infty} \frac{\MSD}{4t_{cpu}} \\
$$
$\Delta \vec{r_i}$は、N_ev回の衝突後の粒子iの変位ベクトル（初期位置からの変位）、N_ev回のイベント実行によってどれだけ動いたか。ラプラシアンではなく変位。
$\Delta \vec{r}$は、全粒子の平均変位ベクトル。系全体が、どの方向にどれくらい動いたかの平均。

$N^*_{ev}$は粒子一個あたりのイベント数。$N^*_{ev} = N_{ev} / N = (全体のイベント数) / (粒子数)$

系全体が移動すると、本来の「粒子の相対的な再配置」が見えにくくなるので、$\Delta \vec{r} - \langle \Delta \vec{r} \rangle$として全体のドリフト（流れ）成分を差し引き、構造緩和に本質的な内部変化のみを抽出している。

- flow component: 流れ成分。componentが構成要素、成分。系全体が動く並進運動。ここでは構造緩和を見たいので、除去する。
- シミュレーションに使用したコアについても論文に記載しておくようだ。何コア用いたか（普通はシングルコアで）も。
- grip-mapping手法は M. Isobe 1999 を用いている。
  TODO: 読む、pdfアリ。https://doi.org/10.1142/S0129183199001042 "剛体円盤分子動力学シミュレーションにおける大規模計算と高速化の手法" 1ループO(NlogN)。N. Murase 2024 (初期の処理が重い代わりに、その後の1ループO(1))も論文があれば読む。



### Ⅲ. results

#### A. liquid phase
##### 1. MSD
N=256^2, ν=0.450 でSEC-all:

$L^*_{c} = L_c / d$ (Lc is chain length)

- plateau: 横ばい、高台。一時的に値がほぼ一定になる区間。

$L^*_c$が大きい場合は、プラトーが中間時間スケールで観測された（$L^*_c$=1.8*10^6）。
この原因は、1つのチェーンにおいて粒子たちが一方向的に移動することである。これはドメインの流れ（部分的な集団運動）に似ている。
このドメインフロー的な運動により、隣接粒子との相対的な拡散は小さくなる（隣接粒子も同じような方向へ移動するから）。これにより、見かけの拡散が抑制された。
→→チェーン長が長すぎると、MSDなどで観測できる拡散効率は低下する。

SEC-allが、「正規拡散（normal diffusion）」の状態に至るまでに最多の移動（イベント）を要した（$N^*_{ev} \ge 10^6$で正規拡散の振る舞いが観測された。）。これは、チェーン長を長くしても、高密度領域（v <= 0.740）においても、改善されなかった。（通常は、高密度や長いチェーン長では構造緩和は進みやすくなる）
→→SEC-allでは、正規拡散の領域に達するまでに、**粒子1つあたりに**100万回ほどのイベント（移動）が必要。SEC-allの拡散非効率性は、単なるパラメータ設定の問題ではなく、アルゴリズムの限界に起因すると考えられる。

- normal diffusion: 正規拡散。$MSD \propto t$となっている状態。
- deem: ~と考える。〜とみなす。
- validity: 有効性、正当性。

SEC-allの結果から、拡散の性質を調査するために$10^6 <= N^*_{ev}$を調査することにした。D_cupの計算にも、その$N^*_{ev}$に対応するt_cpuの範囲を用いた。


##### 2. Lc,Tc dependence of D
SECにおけるチェイン長Lc、NECにおけるチェイン時間Tcが、拡散係数にどう影響するか調べる。
EDMD（チェイン長はない）、SEC-xy, SEC-all, NECで調査した。

**NEC**: Tcを長くするとDev,Dcpuともに「D増大→Dのプラトー」となった。**Tcを無限大、つまりリサンプリング（現在のチェーンを切って、新しい粒子を選び直して新たなチェーンを形成する）しない場合でもプラトーだった**。Dcpuは、NEC,EDMD,SECの順に大きかった。ただしDevはEDMD > NECだった。（Liquid Phase）

一方で、SEC-xy,SEC-allは「D増大→Dのプラトー→D減少」となった。チェーン長を長くしすぎると拡散効率が下がった。

D_evの効率順は、3dでも同様だった。（2019 Marco Klement and Michael Engel）

D_cpuの効率順は、大規模系では上記の通りNEC,SEC-xy,…だが、N<=16384 (128^2)ならば、SEC-xy,NEC,…となった。（各メソッドで、最も効率的となったLc,Tcで比較）

- fluctuation: 急激な変動。不安定で変動しやすい性質
- derive: AからBを引き出す。Aを引き出す
- corresponding: 付随する

N小さい or ν(packing fraction)大きいシステムでは、Lc,Tcによって同一N,νでもDevやDcpuが大きくばらついた。（特に高密度系では、ホッピングが関与するから？）

効率評価のためのサンプリングとして -> 各手法での最も効率が高かった5サンプル（N,νは同一の試行）を取り出して、その平均を$D^{top5}_{ev}$, $D^{top5}_{cpu}$とした。チェーン長ごとに作成。


SEC-xyは、DevよりもDcpuがかなり大きい。その理由は、グリッドマッピング技術によって、衝突検出の際に「衝突候補となる粒子」の数が少なくなっているから、また、その移動方向がx,yのみでさらに候補数が絞れるから、だと考えられる。

##### 3. system size dependency

- three-stage behavior: 拡散・構造緩和ダイナミクスが時間スケールに応じて3つの異なる挙動を示すこと。特に、高密度剛体球系やガラス・ジャミング付近の系などで典型的に見られる。
  1. ballistic or inertial: $MSD(t) \propto t^2$: $ISF \approx 1$
    慣性支配、粒子は自由に動いている。
  2. caging plateau: $MSD(t) \approx const.$: $ISF \approx 高い定置(プラトー)$
    ケージ効果。粒子が周囲に一時的に閉じ込められる。
  3. diffusive regime: $MSD(t) \propto t$: $ISFが急減$
    ケージを破って拡散が始まる。最終的に構造緩和が完了する。

NEC: 先ほどの、Tcが大きくなってもDevが減少しない現象は、N=16^2,32^2,...,512^2でも確認された。

Lc,Tcが小さいと…アクティブ粒子が他粒子に衝突する前（移動中）にチェインがLc,Tcを超えてしまって、衝突（イベント）が生じる前に移動が完了してしまうことがある。その結果、Lc,Tcが小さいと$N_{col}/N_{ev}$が1.0より小さくなってしまう（効率低下を招く）。この振る舞いは、event-chain eventsというよりもlocal MCMC (local Markov Chain Monte Carlo)に似ている。$L^*_c, T^*_c \thicksim 10^1 (L^*_c = Lc / d)$でN_col/N_evが1に漸近し、これはevent-chainsにおける衝突が支配的となったことを示す。

- akin: ~と似て。
- ratio of A to B: A/Bの割合

Devもちょうど$L^*_c, T^*_c \thicksim 10^1$のあたりで振る舞いが変化し、プラトーになっている（Fig3(a)(b),(c)）。これは、Ncol/Nevの割合によってDの初期の増加が生じることを示し、つまり、MCMC-likeな振る舞いからECMC-likeな振る舞いへの変遷を示している。これをN=256^2と約1600^2という全く異なるシステムサイズで調査しても、同様の振る舞いを示した。

- account for: ~の説明責任を果たす。take account into（〜を考慮する）と似てる。
- traverse: ~を横切る

しかし、SEC-xyは中間段階でわずかな増加を見せており、これは上記の考えによって十分に説明できるものではない。そこで、他にも未解明の微視的機構があるはずだと著者は考えた。ASK: SEC-xyのその振る舞いがどれのことを言っているかわからなかった。

そして、1チェイン中に1回だけアクティブになった粒子数（正規化済み）$N_{1st}$調べた。Lc小だとN1st/Nevは1.0で、大きくなると0に漸近する（直感に一致している。）。つまり、チェーンが長いとほとんど全ての粒子が2回以上アクティブになっている。
Fig3(a),(d)を比較すると（SEC-all）、aの最終段階（Lcを大きくしすぎるとDevが減少するフェーズ）でのDevの減少の傾向はとても似ており、ともにlogでの減少を示している、対数的減衰。…粒子の初衝突の発生頻度の減少開始点はシステムサイズに比例し、Devの減少開始点のLcもシステムサイズに比例した。→→従って、DevとN1stの振る舞いは相関している（あくまでSECの話。NECは、触れていないしTcの増加でDevは減少しなかった）！
~~これは『SEC-allにおいて、構造緩和はほとんど粒子の初衝突によってのみ引き起こされる』と解釈できる？もしそうなら、それはSECが、各チェーン開始時に移動方向を1つに定める（そのチェーン中は、その角度方向に常に移動）から、つまり、2回以上アクティブになる粒子が増えても、それは対象粒子グループが全体的に移動しただけになるから？~~ →→ 直後のSEC-xyの(f),(g)で違うとわかった。SECのイベントチェーンはドリフト性をもち、直線的ではなく面的な走査になるとわかった。
↓
（SECは一次元的な動きだからLx or Lyに比例してN1stが減少するのではないかという直感的予測が外れていたため、）なぜSECにおいて、N1stがシステム長Lx,LyではなくシステムサイズN（Lx^2 or Ly^2）に比例して減少するのかを調査したい（Q. L^*_cとNの比例関係じゃないの？→今回は、N1stの値を固定してみてみるとLcとNの比例、Lcを固定してみるとN1stとNの比例）。そのために、1つのイベントチェーンにおけるアクティブ粒子の軌跡を見てみる。

SEC-xyで見てみて、直感的には1チェーンでは直線的（xまたはy方向）に移動して直線方向のみを走査しそうだが、実際には面を走査していた。
その理由は、アクティブ粒子の変位（displacement）とは異なる僅かなドリフトがあるから。このドリフトによって、周期境界を跨ぐ際に位置が僅かに異なることになり、面的に走査される。これにより、2dの効率的なサンプリングが生じている。
※ある程度拡散された状態をイメージすると、全く同じ方向（+yとする）のdisplacementを続けるとしても、ちょっと横（x方向）の粒子にぶつかって、それが時々起こることでアクティブになっている粒子の座標はどんどんx方向に動くことがイメージできる

(f)は、1チェーン中にドリフトが-x方向から+xになって、やや局所的に面的に走査された例。(g)は、1チェーン中にドリフトが+x方向であり続けたで、全体的に面的に走査された例。
このような現象は、SEC-allでも確認されたので、(e)のNとL^*_cの比例関係がこれで説明できる。

上記のように、SECでは1チェーンで直線（Lx or Ly）な走査がなされるのではなく、面的（N == Lx^2 or Ly^2）な走査がなされるので、NとL^*_cの比例関係が得られるのだろう。

- proportional to: ~と比例した
- trajectory: 軌道、軌跡。
- drift: ランダムな運動の中に含まれる、平均的な方向性のある動き
- 結晶秩序: crystalline order, crystal structure orientational order。結晶の格子方向の整列
- span: ~に及ぶ、広がる
- reduce: ~を減らす。〜にする（悪くする感じ）

そもそも、イベントチェイン中のアクティブ粒子は、近隣粒子との相対位置がばらけることで系を拡散する。
しかし、Lcが長いと、近隣粒子が全て同じ距離同じ方向に動く（SECの面的な走査）。そしてDは$|\Delta \vec{r} - \langle \Delta \vec{r} \rangle|$を用いて計算する。その全体的なフローによって$\langle \Delta \vec{r} \rangle$（全粒子の変位の平均）が大きくなり、Dが小さくなる（$\Delta \vec{r}$の方が大きくなるはずなので）。

全体的なフローが複数回変わる場合、これは、domain-like flow を生じる。これは、フロードメインでのDを小さくする。

- with respect to: ~に関して
the MSD increases linearly with respect to N^*_ev: MSDがNに比例して線形に増加する
- emergence: 出現。出てくること

Fig1は、N^*_ev=10^1になったあたりでMSDがプラトー。その10^1は、「全粒子のアクティブになった平均回数」が1になったあたりに対応している。


NECにおいては：粒子に与える速度分布（Maxwell-Boltzmann分布）のランダムネスのおかげで、SECで観測される系全体でのフローが生じない。それが生じないので、$\langle \Delta \vec{r} \rangle ~ 0$となる（そのままの意味。全体の相対変位の平均がほぼない→全体的な動きというのがほぼない）ので、DはTcを大きくしても小さくならない。

しかし、リサンプリングなしでは、システムはirreducibility（不可約性）が常に保証されるわけではない（一応気をつけてねってこと）。
また、スパースハードディスク系では gridlocks が頻発するので注意。グリッドロックとは、特に、イベントチェーンが特定の小さな粒子群の間だけで往復してしまう状況。グリッドロックにより、A->B->C->A...のようなcycleが生じてしまう。


- irreducible: ir + reduce + able -> 減らせない、単純化できない。
統計物理では、**irreducibility**で不可約性（ergocityの一条件）。**任意の状態から他の状態に遷移できる**という性質。
モンテカルロ法においては：
「サンプリングが十分に多様で、系の状態空間を網羅できるか」
しかし、数学的にはirreducibility（不可約性）が常に保証されるわけではない。
つまり：
特定の構成では、NECが「閉じた運動パターン」に閉じ込められる可能性がある
これは「見かけ上 ergodic に見えても、**厳密には空間を網羅していない**」ことを意味する。
- sparse: 疎な

**NECでは、$D^{top5}_{ev} \propto \log{N}$となった（初出のはず）。**
もしこの傾向がNが大きくなっても同様なら、熱力学極限（$N \rightarrow \infty, A \rightarrow \infty$(area,面積)）において、**このDが正の無限大に発散することを意味する。**
すなわち、無限系では拡散係数が発散するという異常拡散的な挙動を示唆している。**通常、拡散係数は系サイズと無関係な定数に収束するべき（エルゴード系では）。**
この現象にはさらなる研究が必要だ。


#### B. solid phase

- configuration: 配置の意味もある
- monodisperse: mono + disperse: 1つの＋分散、分布 -> 1種類の(粒子系の)
- basin: 円錐の入れ物。剛体円盤の粒子のホッピング運動の移動先になるような空間のこと
- potential landscape: ポテンシャルを地形のように表した図。普通にポテンシャルのグラフ。

高密度系では、1種類の粒子で構成された系でも、ホッピング運動が準的に支配的だ。

相転換をする ν>=0.720 をECMCで考える。結晶状態を考える。
粒子数は、N=256^2。

##### 1. MSD, D

- reminiscent of: ~を思い起こさせる。〜を感じさせる
- hallmark: その現象や状態を特徴づける決定的なサインのこと
- subsequent: 次の。続いて起こる
- manifest: ~を明らかにする。政治のマニフェストは信条を明示しているからマニフェスト
- criterion: （何らかの判断や判定をするための）原則、基準

ν=0.74: 
[MSD (NEC)]
MSD/d^2 の値。d=(粒子の直径)
1. 初期段階の早いMSD増加がみられる（β-relaxation：粒子が一時的にケージ効果を受ける。局所的な運動のみ、粒子はまだ閉じ込められている）。
2. 次にプラトー。MSDのプラトーはガラスの2段階緩和っぽい。このプラトーはケージ効果。
3. プラトーの後に、α-relaxationがみられる（粒子がケージを破って飛び出す。ジャンプ・再配置。急激な立ち上がり）
4. その後に、正規拡散（$MSD \propto t$の状態。ブラウン運動、熱的な運動。エルゴード的に平衡化された）がみられる。

上記の4つの状態は、構造緩和や拡散ダイナミクスの時間発展を表現する典型的な段階だ。特に、ガラス・高密度ハードディスクなどの解析において動的相関関数（MSD,ISFなど）を理解するための枠組みとなっている。

[Dev]
Dev/d^2 の値。d=(粒子の直径)
Lcに対し、SECはliquid phaseと同様の3段階の増加→プラトー→減少。NECもliquid phaseと同様に増加→プラトー。

ν=0.75:
0.74と比べて大きく振る舞いが変化！
[MSD (NEC)]
1. β-relaxation
2. プラトー
3. プラトー
4. ステップ的な急増の後、プラトー: NECの各シミュレーションで時々観測された。SEC,EDMDでも観測された。これは、ホッピング運動が生じたのではないか。($10^6 < N^*_{ev} < 10^7$の範囲でこの論文は値を計測している。$N^*_{ev}=N_{ev}/N$(1粒子あたりの平均イベント数)なので、1粒子100万〜1000万イベント実行後に評価されているということ)

[Dev]
どのLc,Tcでも、SEC,NECでほぼ0。明確に拡散されていない。

- magnitude: 大きさ。量。magnitude of efficiency differences -> 効率の差の大きさ

fig4(c):
[$D^{top5}_{ev}$]
v<=0.744では、占有率の増加とともにゆっくりと減少（Dの大きさランキングEDMD,NEC,SEC-xy,SEC-allを保ったまま）。
v>=0.764では、Dは急変しつつ、そのランキングは不安定になる。（v==0.746では、ランニングはそのまま。しかし、効率低下率も手法感の効率の差の大きさも、vが小さい領域とは異なる）

「1粒子100万〜1000万イベント実行後に評価」だと、stable diffusion (normal diffusion的な)はv<=0.744にて観測されうる（N=256^2）。


fig4(d), table2:
[Dcpu]
v==0.740でLc,Tcに対するDcpuを考える。
なんと、SEC-xyが$10^1 <= L^*_c <= 10^3$くらいの時にNECを抜いてDcpuが大きかった。Lc,Tcをいじった結果の最高Dcpuも、NECよりSEC-xyが大きかった。


##### 2. microscopic mechanisms of diffusion
固相での拡散の占有率依存性を調べる→MSD的な値を調べた。N^*_ev=10^4にてNECで。
占有率が.74,.75でのMSDの急増におけるHeterogeneityを明らかにした。これはFig4(a)のMSDの急増のこと。
.74,.75のダイナミクスは基本的に似ているが粒子がアクティブになる頻度が異なる。74(固相)では同時的・連続的に粒子のアクティベーションが起こるため、MSDの線形な増加（α-relaxation）が生じる。
これは、75におけるステップ的増加が多粒子で頻繁に起こることで、線形なMSDに見えているのだと癇癪できる。

- heterogeneity: 系の中に“局所的な違い・ばらつき・非一様な性質”が存在すること。局所的には「よく動く領域」「ほとんど動かない領域」が混在していること。ヘキサティック相は強いヘテロジェネイティを持つ。
- superposition: 複数のものを重ね合わせた合成効果
- interpret: ~を解釈する
- coarse-grained: ビシ的な詳細を捨てて巨視的・平均的に扱うこと。coarse->荒い、ざっくりとした
- intrinsic: 本質的な。固有の

局所的な拡散を観察してみる。そのために、短時間の熱的な揺らぎ（ケージ内のブラウン運動）を取り去って本質的な運動を観察するために、粗視化した粒子位置（時間平均的なもの）を考える。
-> **ガラスで見られるひも状のホッピング運動のような運動が観測された。（ヒモ状＝＝ループするということ。ケージからの脱出が、局所的な空間のやり取りで進む。）**
このようなHeterogeneityダイナミクス・ホッピング運動は、**ハードディスク高密度系の固相（v>=0.72）での、平衡系における本質的な緩和機構だ。**なぜなら、これら現象が本研究のどの方法でも確認されたからだ。（アルゴリズム固有のものではなく、系の物理的本質に由来するものだ）

- concentration: 集中、濃度、濃縮
- iso-configuration: アイソ・configuration（isolated-configuration）。粒子の初期位置（構造）は同じで、速度や運動の初期条件だけを変えたサンプル群(アンサンブルを考えている)

※ホッピング運動とここでは書いているが、ECMCの挙動がそのホッピング運動ということ。（ECMCはそもそも物理的に適切なものと示されているわけではなく、結果的に（物理的に適切な手法で行った場合と同様の）平衡状態が得られるというだけ。それが特に2d融解系などなどでは早いので嬉しいということ。平衡化の過程をショートカットできないか？というのは大きなモチベーション）

ホッピング運動と拡散の関係：
ホッピング濃度c→ホッピング粒子の割合を表す。そのために中身でヘビィサイド関数θ(x)（x>0で1, x<=で0）でジャンプを検出する。aでホッピング距離を表してa/dをパラメータとすることで、粒子直径に対してこれ以上動いたらそれはジャンプとする、としている（ヘビィサイド関数のなかで引く）。熱による振動（熱的ゆらぎ）に起因したホッピングを数えてしまわないように、ソシカした粒子位置を用いる

Fig6：
cとD^top5_evに強い正の相関がある。→固相では、拡散はヒモ状的なホッピング運動が支配的だと考えられる。
v=0.75では各粒子が自律的かつ非同期的にホッピングする。これがMSDの75におけるステップ的上昇を引き起こしている。

v<=0.75では、$10^6 < N^*_{ev} < 10^7$で適切だった。しかし、それ以上の占有率の場合は適用できないだろう。なぜなら、ホッピングが生じるまでの待ち時間がより大きくなり、拡散係数の値を小さく評価してしまう可能性があるから。



### Ⅳ. concluding remarks
NECでは拡散係数がシステムサイズNにlog比例した。これは熱力学極限において拡散係数が発散しうることを示している。より大きなNでのデータ不足の可能性はあるが、調査の余地がある。
RES: より大きなNでの拡散係数DevとNの関係。512^2まではMugitaがやってる。

N=256^2ではのv<=0.744の固相では…
ヒモ状的なホッピング運動が拡散に支配的だ。
NECが拡散係数で最も高い効率を示した。しかし、拡散効率はどの手法でも占有率が上がると下がり、v=0.760あたりで消えた（ほぼ0になった）。

※ v=0.760くらいの占有率では、拡散はほぼ生じない。もし無理やり拡散させようとするなら、主に2成分以上の系において、異なる種類の粒子の位置をスワップして、ホッピング運動を誘う方法がある。（高密度系でも、1成分系のハードディスク系はやるモチベーションはあまり持たれていないっぽい？）

TODO: Mugitaの次の論文で「拡散のシステムサイズ依存性」「NECの拡散係数のシステムサイズ依存性」「NECにて拡散係数が熱力学極限で発散するか、それがlong-time tailsにおける渦流によるものなのか」を研究してるかチェックする

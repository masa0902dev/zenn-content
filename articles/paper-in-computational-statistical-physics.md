---
title: "【計算統計物理】論文ノート、英単語や用語ノート"
emoji: "📝"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["研究", "計算統計物理", "論文", "英語"]
published: true
---

# これは何？

- 主に計算統計物理分野の論文/スライド等を読んだ際のノート、関連事項を調べたノート。
- 英単語や用語の意味と使われ方のメモ。
- 論文を読むたびに追記する。

:::message alert
CAUTION:

1. 他の分野や文脈においては、用語等の意味合いが違う場合もあります。
2. 私の知識不足により誤りを含む可能性があります。
   :::

:::details 個人的な Zenn メモ

TODO: 私が後でやるべきこと
ASK: 私が後で聞くべきこと
RES: 私が後で考えてみたりシミュレートしてみたいこと

- Zenn での数式の参考 (Zenn は$\KaTeX$が使える):

  - `npx zenn preview`で見れば良い。
  - ⭕️: $a=10$, ❌: $ a=10 $ (インラインは空白ダメ)
  - 数式ブロックは、上を1行空ける必要あり。
  - [Zenn で数式を書く方法](https://zenn.dev/dmiyamo3/articles/34fb48a88aa813beffc0)
  - [Zenn で数式を表示する](https://zenn.dev/ykyki/articles/math-formulae-in-zenn)

- Zenn での目次は、heading2 まで表示される。
- [Zenn の Markdown 記法一覧](https://zenn.dev/zenn/articles/markdown-guide)
  :::

# 論文

## D. Mugita 2024: Microscopic Mechanisms of Diffusion Dynamics…

https://arxiv.org/abs/2410.05590
author: Daigo Mugita, Masaharu Isobe

included:

- structural relaxation in highly dense system
- fluid phase and solid phase
- hard disk / sphere system
- Newtonian Event-Chain (NEC), Straight Event-Chain (SEC), Event-Chain Monte Carlo (ECMC)
- Efficiency analysis with respect to event-chain length (Lc), duration (Tc), system size, and relaxation performance
- diffusion coefficients in equilibruim state (NOT equilibration)

not included:

- coexistence phase or hexatic phase
- algorithmic details or derivation of the NEC method itself -> TODO: read paper about NEC algorithm itself

### Ⅰ. intro

- substantial 実質的な。かなりの。
- seminal: 大きな影響を与えた

平衡化と緩和は似ているが違う。平衡化は平衡状態に向かう全体的なプロセスで、緩和は局所的な乱れが静まる個別の道筋。
平衡状態は、定温・定体積系では：自由エネルギー F=U-TS が最小。平衡化はこの F が極小に近づいていく過程に対応。

- equilibration: 平衡化。非平衡状態から平衡状態に到達するまでの動的過程、プロセス。
- equilibrium: 平衡。時間的にマクロな観測量が変化しない状態、定常状態。
- relaxation: 緩和。緩和時間 τ（相関の消失にかかる時間）に使う、自己相関関数 $C(t) \sim exp(-t/\tau)$。τ が大きいほど相関が長く残るので、状態の記憶が長く、独立な状態が得にくくなる。

- methodology: 方法論。戦略的なアプローチ
- elucidate: 解明する
- incorporate: 取り入れる。新たな要素・理論・手法などを既存モデル・アルゴリズムに組み込む

ECMC は、MCMC（Markov Chain Monte Carlo）に factorization, lifting の概念を適用したサンプリング手法。

- factorization: 因数分解。特に MCMC では、目的分布 π(x)を条件付き分布の積として因数分解すること。高次元からのサンプリングを、部分空間でのサンプリングに分割できる。
- lifting: 遷移。特に MCMC では、元のマルコフ連鎖の状態空間を拡張して、より効率的（高速）な遷移を可能にする手法。通常の MCMC では時間的に可逆な遷移だが、リフティングによって非可逆（非対称）な遷移を導入して拡散を早める。

Metroppolis filter とは、試行遷移（trial move）を受け入れるか拒否するかを決めるフィルター処理。
このフィルターによって、望ましい平衡分布（例えばボルツマン分布）に従うサンプル列が得られる。つまり、メトロポリスアルゴリズムの需要確率の部分そのもの。
状態 x に例えば方向や速度などの補助変数を加えて、変数を拡張する。これによって「進行方向に沿ったバイアスのある遷移」ができて、ランダム性を減らせる。

$$
受容確率A(x -> x') = min(1, \frac{\pi(x')}{\pi(x)}) \\
\pi(x)は目標とする平衡分布で、例えばボルツマン分布 \pi(x) = \exp(-\beta E(x))
$$

新しい状態がより低エネなら必ず受け入れる。高エネでも確率的に受け入れる（これは局所最適化に陥らないためである）。
このフィルターによって、詳細釣り合い条件（detailed balance）を満たした平衡分布を得る。

これに対し、ECMC は factorization, lifting によって高速なサンプリングを実現している。
ECMC は、MCMC と違って detailed balance は満たさない（満たすことを必須としない設計だ）が、global balance (全体釣り合い条件)を満たしている。

- consist of: ~から成り立つ。

ECMC はアクティブ粒子のほか粒子との衝突をイベントとする。

NEC（Newtonian Event-Chain）は ECMC の一種。粒子位置の置き換えの際に、粒子の速度 v を考慮する。これは EDMD のアナロジーである。
NEC は特に、融解過程・核形成速度・拡散係数を計算する際に大きな優位をもつ。
NEC はさらに、hard anistoropic particle (硬い（オーバーラップしない、重ならない）異方性（形状に対称性の破れがある、楕円や棒状など）粒子) への適用が「近似なしで」可能。これは、効率的な接触検出アルゴリズムを組み込んだことで実現した。

- analoguos: ~に類似して。アナロジーの形容詞。

- necleation rates: 核形成速度、J で書かれることが多い？単位体積・単位時間あたりに新たな核が生じる確率。
  核形成: 系の中に、小さな新しい相が自発的に生じる現象。
- diffusion coefficients: 拡散係数、D で書かれることが多い。

- anisotropic: 異方性の。anisotropy（異方性）の形容詞

i.e. / e.g. どっちがどっち？

```text
e.g. → for example: ギリシャ語でexempli gratia。具体例をあげる。

Sophie loves picking fruit (e.g., strawberries, apples, blueberries and peaches).
ソフィーは果物狩りが好きです（たとえばイチゴ、リンゴ、ブルーベリー、桃など）


i.e. → that is / in other words (つまり)：ギリシャ語でid est。言い換えたり明確化する。specifically, namely。

Only one president, i.e., Richard Nixon, resigned from office.
辞任した大統領は1人、すなわちリチャード・ニクソンだけです
```

- exceptionally: 並外れて、非常に（程度が例外的に大きいってこと）

構造緩和（粒子位置の緩和）は、特に高密度系では、非常に困難。なぜなら、排除体積効果が支配的だから。
排除体積効果が支配的だと、粒子が 1 回のイベントで動ける程度（その状態から変化できる程度）が非常に小さい。なぜなら…

1. 粒子が互いにめり込めないので、自由に動けないから。（自由に動ける距離が小さいから）
2. （高密度系では、粒子が詰まっているから 1 イベントあたりに動ける距離が小さいから）

上記が原因となって構造緩和の進行が遅いことで、系の時間自己相関関数はなかなか減衰しない。

- excluded-volume effect: 排除体積効果。
  排除体積は、ある粒子が存在するときにその周囲に他の粒子が侵入できない空間、のこと。これは、単なる幾何学的な粒子のサイズだけの話ではなく、粒子の形状や向きにも依存する。
- dominant excluded-volume effect: 系の性質（相転移、構造など）が、エネルギー的要因ではなく、ほとんど排除体積効果だけによって決まっている状態。つまり、粒子同士の引力や静電相互作用などはほとんど関与せず、粒子が互いに重ならないという条件だけが、系のマクロな挙動を支配している状態。
  これは、高密度・ハード粒子系で典型的である。

構造緩和は、glassy physics (ガラス状態やガラス天威の統計力学的な性質などの分野) での「slow dynamics (遅い動力学, 系が時間に対して非常にゆっくりと進展する現象や対象)」おいて、最大の関心事だ。
ガラスなどの、高密度系での構造緩和を(定量的に)評価するにあたって、MSD, ISF, NGP は重要な指標となる。

そもそもガラスとは: 液体のように無秩序だが、個体のように動かない物質の状態のこと。構造的には液体（短距離秩序しかない）だが、力学的には固体（剪断応答する）というハイブリッド。

- metrics: 指標。

<br>

**MSD**, mean square displacement:
粒子の平均的な移動距離の 2 乗を時間経過とともに測った量

$$
MSD(t) = \langle |\vec{r(t)} - \vec{r(0)}|^2 \rangle
$$

<.>は、粒子と初期時刻についての平均。MSD が十分に大きな値に達すれば、それは粒子がもはや初期位置を覚えていないということ。よって、MSD が十分大きければ、構造緩和が完了したと言える。

**ISF**, intermediate scattering function:
ミクロな密度揺らぎの時間的相関を測る関数。

$$
F_s (q, t) = \langle \exp(i q \cdot |\vec{r(t)} - \vec{r(0)}| ) \rangle
$$

q は波数ベクトル、<.>はアンサンブル平均（または時間平均）。初期時刻で Fs(q,0) = 1 (完全相関)。時間が経つと、粒子が動いて Fs(q,t)は 0 に減衰する。減衰の仕方から、特定スケールでの構造緩和の進行状況がわかる。
Fs が十分に 0 近くに減衰したら、粒子の配置が記憶を失ったということ。よって、ISF が十分大きければ、構造緩和が完了したと言える。
特に、緩和時間$\tau_\alpha$(α-緩和時間)を$F_s(q,\tau_\alpha) = \langle \exp(i q \cdot |\vec{r(\tau_\alpha)} - \vec{r(0)}| ) \rangle = e^{-1}$となる時間として定義することが多い。

**NGP**, non-gaussian parameter:
粒子の移動分布が単なるガウス分布（正規分布）からどれだけズレているかを定量化する指標。

$$
2次元系の典型 (3次元系なら分母にかけてる係数が3になる) \\
\def \DIFF #1 { |\vec{r(t)} - \vec{r(0)}|^{#1} }
\def \ANGLE #1 { \langle #1 \rangle }

\alpha_2 (t) = \frac{ \ANGLE{\DIFF{4}} }{2 \ANGLE{\DIFF{2}} ^2 } - 1
$$

G 的挙動(理想的な G 分布)、つまり普通のブラウン運動なら $\alpha_2(t)=0$。
$\alpha_2(t)>0$なら、G 分布に比べて、遠くまで動く粒子が多く存在する(広がった移動分布（尾が太い）を持つ)。
構造緩和の過程で、NGP はピークを持つことが多い。このピーク時刻は、粒子軍における異常な動きの最大化時点と対応し、$\tau_\alpha$ (α-緩和時間) に近いことが多い。

<br>

ensemble average (アンサンブル平均):
ある時刻に存在しうる全ての状態を集めた「仮想的な集団（＝アンサンブル）」に対して、その物理量の平均をとること。
エルゴード仮説が成り立つ場合、アンサンブル平均と時間平均は一致するとされる(エルゴード仮説のもとで考えることが多い)。アンサンブル平均は、ある物理量の**その時刻における**状態の平均なので注意。

$$
物理量Aのアンサンブル平均 \\
\langle A \rangle = \int A(x)P(x) dx
$$

P(x)は状態 x にある確率（平衡分布なら、ボルツマン分布）。確率的に重み付けして平均することで、ミクロな揺らぎを均して、再現性のあるマクロな物理量が得られる。
粒子位置、エネルギー、自己相関関数、MSD, ISF などに用いられることが多い。

ECMC, EDMD の構造緩和・粒子拡散の数値的アプローチは大きく異なるため、その性能比較は困難だ。

- metastable state: 準安定状態。完全な安定状態（熱力学的平衡）ではないが、長い時間安定して存在できる状態。
  最終的には、より低い自由エネの本当の平衡状態に移行する。しかし、そこへ行くためにエネルギー障壁があり、それをなかなか越えられないので、長い時間安定して存在できる状態。自由エネが局所的な最小値をとっている状態。
  安定状態(global minimum)も準安定状態(local minimum)も、自由エネ F について$\frac{dF}{dx}=0, \frac{d^2F}{dx^2}>0$を満たす。極小値なので当然。

- attain: 達する。達成する
- optimal: 最適な
- physical properties: 物理的特性。property が加算で「特性」。科学的なニュアンスでは特性の意味が多い。
- elusive: 見つけたりするのが困難、達成するのが困難。形容詞

ここでは、構造緩和の効率を測定するために、イベント（衝突）回数・CPU 時間を用いている。
（ただし、NEC のチェイン長さには、CPU 時間ではなく粒子の持つ速度 v を用いて時間を計算する。チェイン長さは Tc）

### Ⅱ. model and simulation methods

粒子のエネルギーは$1/\beta = 1/k_B T$としている。
質量 m, 直径 d = 2σ としているので、次元解析から、自然な時間単位 τ は下記の式になる。

- unit of time: 時間単位。系の時間的なスケールを測るための基準量。計算統計物理では、時間単位は「自然単位」で定義することが多い（この自然単位==1 となるように値を取ることが多い）。
  次元解析によって定めるには、この場合、粒子直径 d、質量 m、エネルギー 1/β (熱エネルギー)を用いる。
  自然な時間単位 τ は、粒子が自分のサイズ分動くのにかかる典型時間が基準となる。

  $$
  \tau = d \sqrt{\beta m}
  $$

  この自然単位 τ は、例えば NEC の鎖長 Tc（チェーン時間）を計算する際に現れるわけではない。しかし、シミュレーション結果の物理解釈において、構造緩和や拡散係数と結びつけて考えるには τ が必要。

- 次元解析
  L, M, T（長さ、質量、時間）から考える。
  上例では、L=2σ=d, M=m, E=1/β である。

$$
E = \frac{1}{2} m v^2 などから (エネルギーE)=M L^2 T^{-2} \\
\therefore T = L \sqrt{E^{-1} M}
$$

[相転移について既知の情報] **ハードディスクのシステムについて**、システムの充填率 $\nu = \pi \sigma^2 \cdot N / A$ (2D, A is area) に対しての相 ↓

| $\nu$             | state                                 | description                                                                                                                                        |
| ----------------- | ------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------- |
| v < 0.700         | liquid                                | 粒子は完全にランダムに動ける。短距離秩序しかない。MSD がすぐリニアになり、緩和構造時間が短い                                                       |
| 0.700 < v < 0.716 | coexistence region (liquid and solid) | 巨視的には相分離が見られる（結晶ドメイン＋液体領域）。第一種相転移の兆候 (最近の EDMD や ECMC の大規模計算によって検出された)                      |
| 0.716 < v < 0.720 | hexatic                               | 方向秩序はあるが、位置秩序はない中間的な相。イメージとしては、配向秩序変数が異なる固相が複数ある状態（グローバル配向秩序変数を考慮する必要はある） |
| 0.720 < v         | crystal                               | 粒子が結晶格子状に配置。六方格子構造。並進秩序が準長距離的に存在している。動きは小さく、拡散係数が 0 に近づく                                      |

ここでは、液相と固相のみシミュレートしている。

2 次元系における固体化は、3 次元系とは本質的に異なる。
3d: liquid -> solid の第一種相転移。2d: 段階的に変化する。中間層が現れる。

- threshold: 閾、閾値（しきいち）。

NEC は、粒子の速度分布として Maxwell-Boltzmann 分布を与える（EDMD と似ている）。鎖長として、粒子の速度と移動距離から計算した経過時間を合計した Tc を用いる。粒子の速度には、$v_{rms} = \sqrt{\langle v^2 \rangle}$を用いる（二乗のアンサンブル平均のルート, root mean square）。

- diffusion coefficients: 拡散係数 D。coefficitent==係数。

ここでは拡散係数として、$D_{ev}$ (based on number of events $N^*_{ev}$), $D_{cpu}$ (based on CPU time $t_{cpu}$) を用いる（M. Klement 2019, H. Banno 2022 に対応）。D は MSD から計算。

$$
\gdef \MSD {\langle |\Delta \vec{r} - \langle \Delta \vec{r} \rangle |^2 \rangle}

\MSD = \frac{1}{N} \sum_{i=1}^{N} |\Delta \vec{r_i} - \langle \Delta \vec{r} \rangle |^2 \\
$$

$$
\def \MSD {\langle |\Delta \vec{r} - \langle \Delta \vec{r} \rangle |^2 \rangle}

D_{ev} = \lim_{N^*_{ev} \rightarrow \infty} \frac{\MSD}{4N^*_{ev}} \\
D_{cpu} = \lim_{t_{cpu} \rightarrow \infty} \frac{\MSD}{4t_{cpu}} \\
$$

$\Delta \vec{r_i}$は、N_ev 回の衝突後の粒子 i の変位ベクトル（初期位置からの変位）、N_ev 回のイベント実行によってどれだけ動いたか。ラプラシアンではなく変位。
$\Delta \vec{r}$は、全粒子の平均変位ベクトル。系全体が、どの方向にどれくらい動いたかの平均。

$N^*_{ev}$は粒子一個あたりのイベント数。$N^*_{ev} = N_{ev} / N = (全体のイベント数) / (粒子数)$

系全体が移動すると、本来の「粒子の相対的な再配置」が見えにくくなるので、$\Delta \vec{r} - \langle \Delta \vec{r} \rangle$として全体のドリフト（流れ）成分を差し引き、構造緩和に本質的な内部変化のみを抽出している。

- flow component: 流れ成分。component が構成要素、成分。系全体が動く並進運動。ここでは構造緩和を見たいので、除去する。
- シミュレーションに使用したコアについても論文に記載しておくようだ。何コア用いたか（普通はシングルコアで）も。
- grip-mapping 手法は M. Isobe 1999 を用いている。
  TODO: 読む、pdf アリ。https://doi.org/10.1142/S0129183199001042 "剛体円盤分子動力学シミュレーションにおける大規模計算と高速化の手法" 1 ループ O(NlogN)。N. Murase 2024 (初期の処理が重い代わりに、その後の 1 ループ O(1))も論文があれば読む。

### Ⅲ. results

#### A. liquid phase

##### 1. MSD

N=256^2, ν=0.450 で SEC-all:

$L^*_{c} = L_c / d$ (Lc is chain length)

- plateau: 横ばい、高台。一時的に値がほぼ一定になる区間。

$L^*_c$が大きい場合は、プラトーが中間時間スケールで観測された（$L^*_c$=1.8\*10^6）。
この原因は、1 つのチェーンにおいて粒子たちが一方向的に移動することである。これはドメインの流れ（部分的な集団運動）に似ている。
このドメインフロー的な運動により、隣接粒子との相対的な拡散は小さくなる（隣接粒子も同じような方向へ移動するから）。これにより、見かけの拡散が抑制された。
→→ チェーン長が長すぎると、MSD などで観測できる拡散効率は低下する。

SEC-all が、「正規拡散（normal diffusion）」の状態に至るまでに最多の移動（イベント）を要した（$N^*_{ev} \ge 10^6$で正規拡散の振る舞いが観測された。）。これは、チェーン長を長くしても、高密度領域（v <= 0.740）においても、改善されなかった。（通常は、高密度や長いチェーン長では構造緩和は進みやすくなる）
→→SEC-all では、正規拡散の領域に達するまでに、**粒子 1 つあたりに**100 万回ほどのイベント（移動）が必要。SEC-all の拡散非効率性は、単なるパラメータ設定の問題ではなく、アルゴリズムの限界に起因すると考えられる。

- normal diffusion: 正規拡散。$MSD \propto t$となっている状態。
- deem: ~と考える。〜とみなす。
- validity: 有効性、正当性。

SEC-all の結果から、拡散の性質を調査するために$10^6 <= N^*_{ev}$を調査することにした。D\*cup の計算にも、その$N^\**{ev}$に対応する t_cpu の範囲を用いた。

##### 2. Lc,Tc dependence of D

SEC におけるチェイン長 Lc、NEC におけるチェイン時間 Tc が、拡散係数にどう影響するか調べる。
EDMD（チェイン長はない）、SEC-xy, SEC-all, NEC で調査した。

**NEC**: Tc を長くすると Dev,Dcpu ともに「D 増大 →D のプラトー」となった。**Tc を無限大、つまりリサンプリング（現在のチェーンを切って、新しい粒子を選び直して新たなチェーンを形成する）しない場合でもプラトーだった**。Dcpu は、NEC,EDMD,SEC の順に大きかった。ただし Dev は EDMD > NEC だった。（Liquid Phase）

一方で、SEC-xy,SEC-all は「D 増大 →D のプラトー →D 減少」となった。チェーン長を長くしすぎると拡散効率が下がった。

D_ev の効率順は、3d でも同様だった。（2019 Marco Klement and Michael Engel）

D_cpu の効率順は、大規模系では上記の通り NEC,SEC-xy,…だが、N<=16384 (128^2)ならば、SEC-xy,NEC,…となった。（各メソッドで、最も効率的となった Lc,Tc で比較）

- fluctuation: 急激な変動。不安定で変動しやすい性質
- derive: A から B を引き出す。A を引き出す
- corresponding: 付随する

N 小さい or ν(packing fraction)大きいシステムでは、Lc,Tc によって同一 N,ν でも Dev や Dcpu が大きくばらついた。（特に高密度系では、ホッピングが関与するから？）

効率評価のためのサンプリングとして -> 各手法での最も効率が高かった 5 サンプル（N,ν は同一の試行）を取り出して、その平均を$D^{top5}_{ev}$, $D^{top5}_{cpu}$とした。チェーン長ごとに作成。

SEC-xy は、Dev よりも Dcpu がかなり大きい。その理由は、グリッドマッピング技術によって、衝突検出の際に「衝突候補となる粒子」の数が少なくなっているから、また、その移動方向が x,y のみでさらに候補数が絞れるから、だと考えられる。

##### 3. system size dependency

- three-stage behavior: 拡散・構造緩和ダイナミクスが時間スケールに応じて 3 つの異なる挙動を示すこと。特に、高密度剛体球系やガラス・ジャミング付近の系などで典型的に見られる。
  1. ballistic or inertial: $MSD(t) \propto t^2$: $ISF \approx 1$
     慣性支配、粒子は自由に動いている。
  2. caging plateau: $MSD(t) \approx const.$: $ISF \approx 高い定置(プラトー)$
     ケージ効果。粒子が周囲に一時的に閉じ込められる。
  3. diffusive regime: $MSD(t) \propto t$: $ISFが急減$
     ケージを破って拡散が始まる。最終的に構造緩和が完了する。

NEC: 先ほどの、Tc が大きくなっても Dev が減少しない現象は、N=16^2,32^2,...,512^2 でも確認された。

Lc,Tc が小さいと…アクティブ粒子が他粒子に衝突する前（移動中）にチェインが Lc,Tc を超えてしまって、衝突（イベント）が生じる前に移動が完了してしまうことがある。その結果、Lc,Tc が小さいと$N_{col}/N_{ev}$が 1.0 より小さくなってしまう（効率低下を招く）。この振る舞いは、event-chain events というよりも local MCMC (local Markov Chain Monte Carlo)に似ている。$L^*_c, T^*_c \thicksim 10^1 (L^*_c = Lc / d)$で N_col/N_ev が 1 に漸近し、これは event-chains における衝突が支配的となったことを示す。

- akin: ~と似て。
- ratio of A to B: A/B の割合

Dev もちょうど$L^*_c, T^*_c \thicksim 10^1$のあたりで振る舞いが変化し、プラトーになっている（Fig3(a)(b),(c)）。これは、Ncol/Nev の割合によって D の初期の増加が生じることを示し、つまり、MCMC-like な振る舞いから ECMC-like な振る舞いへの変遷を示している。これを N=256^2 と約 1600^2 という全く異なるシステムサイズで調査しても、同様の振る舞いを示した。

- account for: ~の説明責任を果たす。take account into（〜を考慮する）と似てる。
- traverse: ~を横切る

しかし、SEC-xy は中間段階でわずかな増加を見せており、これは上記の考えによって十分に説明できるものではない。そこで、他にも未解明の微視的機構があるはずだと著者は考えた。ASK: SEC-xy のその振る舞いがどれのことを言っているかわからなかった。

そして、1 チェイン中に 1 回だけアクティブになった粒子数（正規化済み）$N_{1st}$調べた。Lc 小だと N1st/Nev は 1.0 で、大きくなると 0 に漸近する（直感に一致している。）。つまり、チェーンが長いとほとんど全ての粒子が 2 回以上アクティブになっている。
Fig3(a),(d)を比較すると（SEC-all）、a の最終段階（Lc を大きくしすぎると Dev が減少するフェーズ）での Dev の減少の傾向はとても似ており、ともに log での減少を示している、対数的減衰。…粒子の初衝突の発生頻度の減少開始点はシステムサイズに比例し、Dev の減少開始点の Lc もシステムサイズに比例した。→→ 従って、Dev と N1st の振る舞いは相関している（あくまで SEC の話。NEC は、触れていないし Tc の増加で Dev は減少しなかった）！
~~これは『SEC-all において、構造緩和はほとんど粒子の初衝突によってのみ引き起こされる』と解釈できる？もしそうなら、それは SEC が、各チェーン開始時に移動方向を 1 つに定める（そのチェーン中は、その角度方向に常に移動）から、つまり、2 回以上アクティブになる粒子が増えても、それは対象粒子グループが全体的に移動しただけになるから？~~ →→ 直後の SEC-xy の(f),(g)で違うとわかった。SEC のイベントチェーンはドリフト性をもち、直線的ではなく面的な走査になるとわかった。
↓
（SEC は一次元的な動きだから Lx or Ly に比例して N1st が減少するのではないかという直感的予測が外れていたため、）なぜ SEC において、N1st がシステム長 Lx,Ly ではなくシステムサイズ N（Lx^2 or Ly^2）に比例して減少するのかを調査したい（Q. L^\*\_c と N の比例関係じゃないの？→ 今回は、N1st の値を固定してみてみると Lc と N の比例、Lc を固定してみると N1st と N の比例）。そのために、1 つのイベントチェーンにおけるアクティブ粒子の軌跡を見てみる。

SEC-xy で見てみて、直感的には 1 チェーンでは直線的（x または y 方向）に移動して直線方向のみを走査しそうだが、実際には面を走査していた。
その理由は、アクティブ粒子の変位（displacement）とは異なる僅かなドリフトがあるから。このドリフトによって、周期境界を跨ぐ際に位置が僅かに異なることになり、面的に走査される。これにより、2d の効率的なサンプリングが生じている。
※ある程度拡散された状態をイメージすると、全く同じ方向（+y とする）の displacement を続けるとしても、ちょっと横（x 方向）の粒子にぶつかって、それが時々起こることでアクティブになっている粒子の座標はどんどん x 方向に動くことがイメージできる

(f)は、1 チェーン中にドリフトが-x 方向から+x になって、やや局所的に面的に走査された例。(g)は、1 チェーン中にドリフトが+x 方向であり続けたで、全体的に面的に走査された例。
このような現象は、SEC-all でも確認されたので、(e)の N と L^\*\_c の比例関係がこれで説明できる。

上記のように、SEC では 1 チェーンで直線（Lx or Ly）な走査がなされるのではなく、面的（N == Lx^2 or Ly^2）な走査がなされるので、N と L^\*\_c の比例関係が得られるのだろう。

- proportional to: ~と比例した
- trajectory: 軌道、軌跡。
- drift: ランダムな運動の中に含まれる、平均的な方向性のある動き
- 結晶秩序: crystalline order, crystal structure orientational order。結晶の格子方向の整列
- span: ~に及ぶ、広がる
- reduce: ~を減らす。〜にする（悪くする感じ）

そもそも、イベントチェイン中のアクティブ粒子は、近隣粒子との相対位置がばらけることで系を拡散する。
しかし、Lc が長いと、近隣粒子が全て同じ距離同じ方向に動く（SEC の面的な走査）。そして D は$|\Delta \vec{r} - \langle \Delta \vec{r} \rangle|$を用いて計算する。その全体的なフローによって$\langle \Delta \vec{r} \rangle$（全粒子の変位の平均）が大きくなり、D が小さくなる（$\Delta \vec{r}$の方が大きくなるはずなので）。

全体的なフローが複数回変わる場合、これは、domain-like flow を生じる。これは、フロードメインでの D を小さくする。

- with respect to: ~に関して
  the MSD increases linearly with respect to N^\*\_ev: MSD が N に比例して線形に増加する
- emergence: 出現。出てくること

Fig1 は、N^\*\_ev=10^1 になったあたりで MSD がプラトー。その 10^1 は、「全粒子のアクティブになった平均回数」が 1 になったあたりに対応している。

NEC においては：粒子に与える速度分布（Maxwell-Boltzmann 分布）のランダムネスのおかげで、SEC で観測される系全体でのフローが生じない。それが生じないので、$\langle \Delta \vec{r} \rangle ~ 0$となる（そのままの意味。全体の相対変位の平均がほぼない → 全体的な動きというのがほぼない）ので、D は Tc を大きくしても小さくならない。

しかし、リサンプリングなしでは、システムは irreducibility（不可約性）が常に保証されるわけではない（一応気をつけてねってこと）。
また、スパースハードディスク系では gridlocks が頻発するので注意。グリッドロックとは、特に、イベントチェーンが特定の小さな粒子群の間だけで往復してしまう状況。グリッドロックにより、A->B->C->A...のような cycle が生じてしまう。

- irreducible: ir + reduce + able -> 減らせない、単純化できない。
  統計物理では、**irreducibility**で不可約性（ergocity の一条件）。**任意の状態から他の状態に遷移できる**という性質。
  モンテカルロ法においては：
  「サンプリングが十分に多様で、系の状態空間を網羅できるか」
  しかし、数学的には irreducibility（不可約性）が常に保証されるわけではない。
  つまり：
  特定の構成では、NEC が「閉じた運動パターン」に閉じ込められる可能性がある
  これは「見かけ上 ergodic に見えても、**厳密には空間を網羅していない**」ことを意味する。
- sparse: 疎な

**NEC では、$D^{top5}_{ev} \propto \log{N}$となった（初出のはず）。**
もしこの傾向が N が大きくなっても同様なら、熱力学極限（$N \rightarrow \infty, A \rightarrow \infty$(area,面積)）において、**この D が正の無限大に発散することを意味する。**
すなわち、無限系では拡散係数が発散するという異常拡散的な挙動を示唆している。**通常、拡散係数は系サイズと無関係な定数に収束するべき（エルゴード系では）。**
この現象にはさらなる研究が必要だ。

#### B. solid phase

- configuration: 配置の意味もある
- monodisperse: mono + disperse: 1 つの＋分散、分布 -> 1 種類の(粒子系の)
- basin: 円錐の入れ物。剛体円盤の粒子のホッピング運動の移動先になるような空間のこと
- potential landscape: ポテンシャルを地形のように表した図。普通にポテンシャルのグラフ。

高密度系では、1 種類の粒子で構成された系でも、ホッピング運動が準的に支配的だ。

相転換をする ν>=0.720 を ECMC で考える。結晶状態を考える。
粒子数は、N=256^2。

##### 1. MSD, D

- reminiscent of: ~を思い起こさせる。〜を感じさせる
- hallmark: その現象や状態を特徴づける決定的なサインのこと
- subsequent: 次の。続いて起こる
- manifest: ~を明らかにする。政治のマニフェストは信条を明示しているからマニフェスト
- criterion: （何らかの判断や判定をするための）原則、基準

ν=0.74:
[MSD (NEC)]
MSD/d^2 の値。d=(粒子の直径)

1. 初期段階の早い MSD 増加がみられる（β-relaxation：粒子が一時的にケージ効果を受ける。局所的な運動のみ、粒子はまだ閉じ込められている）。
2. 次にプラトー。MSD のプラトーはガラスの 2 段階緩和っぽい。このプラトーはケージ効果。
3. プラトーの後に、α-relaxation がみられる（粒子がケージを破って飛び出す。ジャンプ・再配置。急激な立ち上がり）
4. その後に、正規拡散（$MSD \propto t$の状態。ブラウン運動、熱的な運動。エルゴード的に平衡化された）がみられる。

上記の 4 つの状態は、構造緩和や拡散ダイナミクスの時間発展を表現する典型的な段階だ。特に、ガラス・高密度ハードディスクなどの解析において動的相関関数（MSD,ISF など）を理解するための枠組みとなっている。

[Dev]
Dev/d^2 の値。d=(粒子の直径)
Lc に対し、SEC は liquid phase と同様の 3 段階の増加 → プラトー → 減少。NEC も liquid phase と同様に増加 → プラトー。

ν=0.75:
0.74 と比べて大きく振る舞いが変化！
[MSD (NEC)]

1. β-relaxation
2. プラトー
3. プラトー
4. ステップ的な急増の後、プラトー: NEC の各シミュレーションで時々観測された。SEC,EDMD でも観測された。これは、ホッピング運動が生じたのではないか。($10^6 < N^*_{ev} < 10^7$の範囲でこの論文は値を計測している。$N^*_{ev}=N_{ev}/N$(1 粒子あたりの平均イベント数)なので、1 粒子 100 万〜1000 万イベント実行後に評価されているということ)

[Dev]
どの Lc,Tc でも、SEC,NEC でほぼ 0。明確に拡散されていない。

- magnitude: 大きさ。量。magnitude of efficiency differences -> 効率の差の大きさ

fig4(c):
[$D^{top5}_{ev}$]
v<=0.744 では、占有率の増加とともにゆっくりと減少（D の大きさランキング EDMD,NEC,SEC-xy,SEC-all を保ったまま）。
v>=0.764 では、D は急変しつつ、そのランキングは不安定になる。（v==0.746 では、ランニングはそのまま。しかし、効率低下率も手法感の効率の差の大きさも、v が小さい領域とは異なる）

「1 粒子 100 万〜1000 万イベント実行後に評価」だと、stable diffusion (normal diffusion 的な)は v<=0.744 にて観測されうる（N=256^2）。

fig4(d), table2:
[Dcpu]
v==0.740 で Lc,Tc に対する Dcpu を考える。
なんと、SEC-xy が$10^1 <= L^*_c <= 10^3$くらいの時に NEC を抜いて Dcpu が大きかった。Lc,Tc をいじった結果の最高 Dcpu も、NEC より SEC-xy が大きかった。

##### 2. microscopic mechanisms of diffusion

固相での拡散の占有率依存性を調べる →MSD 的な値を調べた。N^\*\_ev=10^4 にて NEC で。
占有率が.74,.75 での MSD の急増における Heterogeneity を明らかにした。これは Fig4(a)の MSD の急増のこと。
.74,.75 のダイナミクスは基本的に似ているが粒子がアクティブになる頻度が異なる。74(固相)では同時的・連続的に粒子のアクティベーションが起こるため、MSD の線形な増加（α-relaxation）が生じる。
これは、75 におけるステップ的増加が多粒子で頻繁に起こることで、線形な MSD に見えているのだと癇癪できる。

- heterogeneity: 系の中に“局所的な違い・ばらつき・非一様な性質”が存在すること。局所的には「よく動く領域」「ほとんど動かない領域」が混在していること。ヘキサティック相は強いヘテロジェネイティを持つ。
- superposition: 複数のものを重ね合わせた合成効果
- interpret: ~を解釈する
- coarse-grained: ビシ的な詳細を捨てて巨視的・平均的に扱うこと。coarse->荒い、ざっくりとした
- intrinsic: 本質的な。固有の

局所的な拡散を観察してみる。そのために、短時間の熱的な揺らぎ（ケージ内のブラウン運動）を取り去って本質的な運動を観察するために、粗視化した粒子位置（時間平均的なもの）を考える。
-> **ガラスで見られるひも状のホッピング運動のような運動が観測された。（ヒモ状＝＝ループするということ。ケージからの脱出が、局所的な空間のやり取りで進む。）**
このような Heterogeneity ダイナミクス・ホッピング運動は、**ハードディスク高密度系の固相（v>=0.72）での、平衡系における本質的な緩和機構だ。**なぜなら、これら現象が本研究のどの方法でも確認されたからだ。（アルゴリズム固有のものではなく、系の物理的本質に由来するものだ）

- concentration: 集中、濃度、濃縮
- iso-configuration: アイソ・configuration（isolated-configuration）。粒子の初期位置（構造）は同じで、速度や運動の初期条件だけを変えたサンプル群(アンサンブルを考えている)

※ホッピング運動とここでは書いているが、ECMC の挙動がそのホッピング運動ということ。（ECMC はそもそも物理的に適切なものと示されているわけではなく、結果的に（物理的に適切な手法で行った場合と同様の）平衡状態が得られるというだけ。それが特に 2d 融解系などなどでは早いので嬉しいということ。平衡化の過程をショートカットできないか？というのは大きなモチベーション）

ホッピング運動と拡散の関係：
ホッピング濃度 c→ ホッピング粒子の割合を表す。そのために中身でヘビィサイド関数 θ(x)（x>0 で 1, x<=で 0）でジャンプを検出する。a でホッピング距離を表して a/d をパラメータとすることで、粒子直径に対してこれ以上動いたらそれはジャンプとする、としている（ヘビィサイド関数のなかで引く）。熱による振動（熱的ゆらぎ）に起因したホッピングを数えてしまわないように、ソシカした粒子位置を用いる

Fig6：
c と D^top5_ev に強い正の相関がある。→ 固相では、拡散はヒモ状的なホッピング運動が支配的だと考えられる。
v=0.75 では各粒子が自律的かつ非同期的にホッピングする。これが MSD の 75 におけるステップ的上昇を引き起こしている。

v<=0.75 では、$10^6 < N^*_{ev} < 10^7$で適切だった。しかし、それ以上の占有率の場合は適用できないだろう。なぜなら、ホッピングが生じるまでの待ち時間がより大きくなり、拡散係数の値を小さく評価してしまう可能性があるから。

### Ⅳ. concluding remarks

NEC では拡散係数がシステムサイズ N に log 比例した。これは熱力学極限において拡散係数が発散しうることを示している。より大きな N でのデータ不足の可能性はあるが、調査の余地がある。
RES: より大きな N での拡散係数 Dev と N の関係。512^2 までは Mugita がやってる。

N=256^2 ではの v<=0.744 の固相では…
ヒモ状的なホッピング運動が拡散に支配的だ。
NEC が拡散係数で最も高い効率を示した。しかし、拡散効率はどの手法でも占有率が上がると下がり、v=0.760 あたりで消えた（ほぼ 0 になった）。

※ v=0.760 くらいの占有率では、拡散はほぼ生じない。もし無理やり拡散させようとするなら、主に 2 成分以上の系において、異なる種類の粒子の位置をスワップして、ホッピング運動を誘う方法がある。（高密度系でも、1 成分系のハードディスク系はやるモチベーションはあまり持たれていないっぽい？）

TODO: Mugita の次の論文で「拡散のシステムサイズ依存性」「NEC の拡散係数のシステムサイズ依存性」「NEC にて拡散係数が熱力学極限で発散するか、それが long-time tails における渦流によるものなのか」を研究してるかチェックする



## Study of Computational Statistical Physics

固体：分子の位置に規則性（位置秩序）を持つものは結晶と呼ぶ。
剛体球系における融解や結晶化などの相転移は、統計物理学において重要な問題。

状態量が時間的に変化している場合が非平衡状態。非平衡 → 平衡という移行を緩和や平衡緩和と呼ぶ。
平衡状態において状態量に変化はないが、空間的分布にばらつきがある（系全体で値が一様でない）ことがふつう。

圧力・局所密度・配向秩序変数などの結晶構造を表す物理量を調べることは、緩和過程の様子・仕組みを解明する手掛かりになる。

### アンサンブル平均・MC・エルゴード仮説

統計力学では、ミクロな物理量の統計平均をとってマクロ平均値（アンサンブル平均）が計算される。E(n)は状態 n でのエネルギー。$e^{-\beta E(n)}$はボルツマン因子。P(n)は、あるミクロな状態 n が実現する確率分布である。

$$
\def \EXP { e^{-\beta E(n)} }

P(n) = \frac{\EXP}{\int \EXP dn} \\

\langle A \rangle = \int A(n)P(n) dn = \frac{\sum_n A_n \EXP}{\sum_n \EXP}

% \begin{align}
% \langle A \rangle &= \int A(n)P(n) dn \\
%   &= \frac{\sum_n A_n \EXP}{\sum_n \EXP}
% \end{align}
$$

モンテカルロ法（MC）は、ある特定のアンサンブルに対応する状態を上式に従うように M 個発生させ、以下のように物理量 A のアンサンブル平均とする。MC は確率論的モデルである。下の式は、アンサンブル平均（の近似）であって、時間平均ではない。

$$
\langle A \rangle = \frac{1}{M} (A(n_1) + A(n_2) + … + A(n_M))
$$

MCMC（マルコフチェイン MC）は、時刻 t にある動的変数をもつ遷移確率が時刻 t0 より前の状態に依存しない過程（＝＝マルコフ連鎖）を用いて、平衡確率分布 P(n)に従うようにサンプル分布 n_1,...n_M を得る手法である。
マルコフチェインにおいて、周期性を持たない＋どの状態からでも他の状態に到達できる（t1->t2 へ到達できる）場合、エルゴード的であると言う。エルゴード的な系では、アンサンブル平均が定常状態となるし、得られる分布が定常状態になるためにはエルゴード的である（ergodic Markov Chain）必要がある（必要十分）。

エルゴード性（ergodicity）、エルゴード仮説 -> 位相空間での平均は時間平均に等しいとする，統計力学における仮説。
統計力学において、実験では系の時間平均しかとれない。そこで、時間平均とアンサンブル平均が一致することを前提として考える（あくまで前提）。
MC では 1 つの軌道をサンプリングする。この軌道が系全体の相空間を十分サンプリングすること＝エルゴード性が必要。エルゴード性がないと、標本が偏ってしまい、統計量が正しくならない。
エルゴード性は破れる場合がある。→ 特定の初期状態から出発した系が、相空間の一部に閉じ込められるような状況。例えば、ガラス状態、局在化現象(many-body localization)。

MD（分子動力学法）は、エルゴード仮説を用いる。運動方程式を数値計算することで決定論的に値を出して、アンサンブル平均を長時間平均から計算する手法。MC は確率論的なもで平衡状態の静的性質のみ求められるが、MD は動的性質についても求められる。（MC でも ECMC で拡散係数を求めることはある。D.Mugita2024 など）

### 剛体球系について

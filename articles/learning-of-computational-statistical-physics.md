---
title: "計算統計物理学を学んでみよう【学部向け】"
emoji: "🗺️"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["研究", "計算統計物理学", "分子シミュレーション"]
published: false
---

# はじめに
## これは何？
学部生が研究のために「計算統計物理学」を学んだノートです。
この領域に興味を持つ人が増えるといいなぁと思い、ノートを公開しています。

:::message alert
CAUTION:

1. 他の分野や文脈においては、用語等の意味合いが違う場合もあります。
2. 私の知識不足により誤りを含む可能性があります。
:::

:::details 個人的な Zenn メモ

TODO: 私が後でやるべきこと
ASK: 私が後で聞くべきこと
RES: 私が後で考えてみたりシミュレートしてみたいこと

- Zenn での数式の参考 (Zenn は$\KaTeX$が使える):

  - `npx zenn preview`で見れば良い。
  - ⭕️: $a=10$, ❌: $ a=10 $ (インラインは空白ダメ)
  - 数式ブロックは、上を1行空ける必要あり。
  - [Zenn で数式を書く方法](https://zenn.dev/dmiyamo3/articles/34fb48a88aa813beffc0)
  - [Zenn で数式を表示する](https://zenn.dev/ykyki/articles/math-formulae-in-zenn)

- Zenn での目次は、heading2 まで表示される。
- [Zenn の Markdown 記法一覧](https://zenn.dev/zenn/articles/markdown-guide)
:::

## キーワード
- computational statistical physics (csp)
- hard disk / sphere model (剛体円盤/球モデル)
- Event-Chain Monte Carlo (ECMC), Newtonian Event-Chain (NEC)
- Event-Driven Molecular Dynamics (EDMD)
- 統計力学
- structural relaxation (構造緩和)
- 分子シミュレーション

# 計算統計物理学ノート
## 一般
固体：分子の位置に規則性（位置秩序）を持つものは結晶と呼ぶ。
剛体球系における融解や結晶化などの相転移は、統計物理学において重要な問題。

状態量が時間的に変化している場合が非平衡状態。非平衡 → 平衡という移行を緩和や平衡緩和と呼ぶ。
平衡状態において状態量に変化はないが、空間的分布にばらつきがある（系全体で値が一様でない）ことがふつう。

圧力・局所密度・配向秩序変数などの結晶構造を表す物理量を調べることは、緩和過程の様子・仕組みを解明する手掛かりになる。

## アンサンブル平均・MC・エルゴード仮説

統計力学では、ミクロな物理量の統計平均をとってマクロ平均値（アンサンブル平均）が計算される。E(n)は状態 n でのエネルギー。$e^{-\beta E(n)}$はボルツマン因子。P(n)は、あるミクロな状態 n が実現する確率分布である。

$$
\def \EXP { e^{-\beta E(n)} }

P(n) = \frac{\EXP}{\int \EXP dn} \\

\langle A \rangle = \int A(n)P(n) dn = \frac{\sum_n A_n \EXP}{\sum_n \EXP}

% \begin{align}
% \langle A \rangle &= \int A(n)P(n) dn \\
%   &= \frac{\sum_n A_n \EXP}{\sum_n \EXP}
% \end{align}
$$

モンテカルロ法（MC）は、ある特定のアンサンブルに対応する状態を上式に従うように M 個発生させ、以下のように物理量 A のアンサンブル平均とする。MC は確率論的モデルである。下の式は、アンサンブル平均（の近似）であって、時間平均ではない。

$$
\langle A \rangle = \frac{1}{M} (A(n_1) + A(n_2) + … + A(n_M))
$$

**MCMC（マルコフチェイン MC）**: 時刻 t にある動的変数をもつ遷移確率が時刻 t0 より前の状態に依存しない過程（＝＝マルコフ連鎖）を用いて、平衡確率分布 P(n)に従うようにサンプル分布 n_1,...n_M を得る手法である。
マルコフチェインにおいて、周期性を持たない＋どの状態からでも他の状態に到達できる（t1->t2 へ到達できる）場合、エルゴード的であると言う。エルゴード的な系では、アンサンブル平均が定常状態となるし、得られる分布が定常状態になるためにはエルゴード的である（ergodic Markov Chain）必要がある（必要十分）。

**エルゴード性（ergodicity）、エルゴード仮説**: 位相空間での平均は時間平均に等しいとする，統計力学における仮説。
統計力学において、実験では系の時間平均しかとれない。そこで、時間平均とアンサンブル平均が一致することを前提として考える（あくまで前提）。
MC では 1 つの軌道をサンプリングする。この軌道が系全体の相空間を十分サンプリングすること==エルゴード性が必要。エルゴード性がないと、標本が偏ってしまい、統計量が正しくならない。
エルゴード性は破れる場合がある。→ 特定の初期状態から出発した系が、相空間の一部に閉じ込められるような状況。例えば、ガラス状態、局在化現象(many-body localization)。

**MD（分子動力学法）**: エルゴード仮説を用いる。運動方程式を数値計算することで決定論的に値を出して、アンサンブル平均を長時間平均から計算する手法。MC は確率論的なもので平衡状態の静的性質のみ求められるが、MD は動的性質についても求められる。（MC でも ECMC で拡散係数を求めることはある。D.Mugita2024 など）

## 剛体球系について
